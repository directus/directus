(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8277c478"],{"085d":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"interface-many-to-one"},[!1===t.relationSetup?n("div",{staticClass:"notice"},[n("p",[n("v-icon",{attrs:{name:"warning"}}),t._v("\n      "+t._s(t.$t("interfaces-many-to-many-relation_not_setup"))+"\n    ")],1)]):[n("v-select",{class:{"select-loading":t.loading},attrs:{id:t.name,name:t.name,placeholder:t.options.placeholder||"",options:t.selectOptions,disabled:t.readonly,value:t.valuePK,icon:t.options.icon},on:{input:function(e){return t.$emit("input",e)}}}),t.count>t.options.threshold?n("button",{attrs:{type:"button"},on:{click:function(e){t.listingActive=!0}}}):t._e(),n("v-spinner",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"spinner",attrs:{"line-fg-color":"var(--light-gray)","line-bg-color":"var(--lighter-gray)"}}),t.listingActive?n("v-item-select",{attrs:{collection:t.relation.collection_one.collection,fields:t.relatedFields,filters:[],single:"",value:t.stagedValue||t.valuePK},on:{input:t.stageValue,done:t.closeListing,cancel:t.cancelListing}}):t._e()]],2)},l=[],a=n("75fc"),o=n("768b"),r=(n("ac6a"),n("5df3"),n("28a5"),n("7514"),n("8db2")),s=n.n(r);n("a481"),n("4917");function c(t){var e=/{{(.*)}}/g,n=t.match(e);return n=n.map(function(t){return t.replace(/{{/g,"").replace(/}}/g,"").trim()}),n}var u={name:"InterfaceManyToOne",mixins:[s.a],data:function(){return{loading:!1,error:null,items:[],count:null,listingActive:!1,selectionSaving:!1,newSelected:null,stagedValue:null}},computed:{relationSetup:function(){return!!this.relation},relatedPrimaryKeyField:function(){return _.find(this.relation.collection_one.fields,{primary_key:!0}).field},valuePK:function(){return _.isObject(this.value)?this.value[this.relatedPrimaryKeyField]:this.value},relatedFields:function(){var t=this.options.visible_fields;return t&&0!==t.length?t.split(",").map(function(t){return t.trim()}):c(this.options.template)},selectOptions:function(){if(0===this.items.length)return{};var t=this.$helpers.micromustache.compile(this.options.template);return _.mapValues(_.keyBy(this.items,this.relatedPrimaryKeyField),function(e){return t(e)})}},watch:{relation:function(){this.relationSetup&&this.fetchItems()}},created:function(){this.relationSetup&&this.fetchItems()},methods:{stageValue:function(t){this.stagedValue=t},fetchItems:function(){var t=this;if(null!=this.relation){var e=this.relation.collection_one.collection;this.loading=!0;var n={fields:"*.*",meta:"total_count",limit:this.options.threshold};return Promise.all([this.$api.getItems(e,n),this.value?this.$api.getItem(e,this.valuePK):null]).then(function(e){var n=Object(o["a"])(e,2),i=n[0],l=i.meta,r=i.data,s=n[1];t.items=s?[].concat(Object(a["a"])(r),[s.data]):r,t.loading=!1,t.count=l.total_count}).catch(function(e){console.error(e),t.error=e,t.loading=!1})}},closeListing:function(){var t=this;this.$emit("input",this.stagedValue);var e=this.relation.collection_one.collection,n={fields:"*.*",limit:1};this.loading=!0,this.$api.getItem(e,this.stagedValue,n).then(function(t){return t.data}).then(function(e){return t.items=[].concat(Object(a["a"])(t.items),[e])}).catch(function(e){console.error(e),t.error=e,t.loading=!1}).finally(function(){return t.loading=!1}),this.stagedValue=null,this.listingActive=!1},cancelListing:function(){this.stagedValue=null,this.listingActive=!1}}},d=u,f=(n("5e16"),n("2877")),h=Object(f["a"])(d,i,l,!1,null,"0325e2f6",null);e["default"]=h.exports},4917:function(t,e,n){"use strict";var i=n("cb7c"),l=n("9def"),a=n("0390"),o=n("5f1b");n("214f")("match",1,function(t,e,n,r){return[function(n){var i=t(this),l=void 0==n?void 0:n[e];return void 0!==l?l.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=r(n,t,this);if(e.done)return e.value;var s=i(t),c=String(this);if(!s.global)return o(s,c);var u=s.unicode;s.lastIndex=0;var d,f=[],h=0;while(null!==(d=o(s,c))){var p=String(d[0]);f[h]=p,""===p&&(s.lastIndex=a(c,l(s.lastIndex),u)),h++}return 0===h?null:f}]})},"5e16":function(t,e,n){"use strict";var i=n("8fc5"),l=n.n(i);l.a},"8db2":function(t,e){t.exports={props:{id:{type:String,required:!0},name:{type:String,required:!0},value:{type:null,default:null},type:{type:String,required:!0},length:{type:[String,Number],default:null},readonly:{type:Boolean,default:!1},collection:{type:String,default:null},required:{type:Boolean,default:!1},options:{type:Object,default:()=>({})},newItem:{type:Boolean,default:!1},relation:{type:Object,default:null},fields:{type:Object,default:null},values:{type:Object,default:null}}}},"8fc5":function(t,e,n){}}]);
//# sourceMappingURL=chunk-8277c478.982c6e4a.js.map